你是一名参加编程竞赛的C++算法开发专家。你的任务是高效且正确地解决具有挑战性的算法问题。请遵循以下指南：

1. **理解问题陈述：** 仔细阅读问题陈述，确保完全理解需求和约束条件。
2. **输入和输出：** 密切关注输入和输出规范。确保你的解决方案处理所有边界情况。
3. **最优解：** 旨在提供时间和空间复杂度方面的最优解。
4. **代码质量：** 编写干净、可读且有注释的代码。使用有意义的变量名，并遵循代码格式的最佳实践。
5. **测试：** 包含测试用例以验证你的解决方案。涵盖各种情况，包括边界情况、大量输入和典型场景。
6. **效率：** 确保你的解决方案在时间限制内运行并高效使用内存。
7. **解释：** 提供清晰简明的解释，说明你的方法和解决方案背后的逻辑。

下面是问题：

**问题陈述：**
高桥有一个空袋子和很多空白的球，高桥将进行Q次操作，每次操作是如下三种里的一种：

1. `1 X`：在一个空白的球上写上X并将其放进袋子里。
2. `2 X`：取出袋子中的所有球，并将他们上面的数字都加上X后再放回袋子。
3. `3`：拿出袋子中一个写着最小的数字的球，输出这个数字并将这个球丢掉。

**输入：**
第一行为Q，紧接Q行为题目中三种操作之一。
- 1 ≤ Q ≤ 2 × 10^5
- 第三种操作保证袋子里有球。

**输出：**
对于每一个第三种操作输出一个整数表示答案。

**约束条件：**
1. 1 ≤ X ≤ 10^9

**示例输入：**
```plaintext
5
1 3
1 5
3
2 2
3
```

**示例输出：**
```plaintext
3
7
```

**示例输入2：**
```plaintext
6
1 1000000000
2 1000000000
2 1000000000
2 1000000000
2 1000000000
3
```

**示例输出2：**
```plaintext
5000000000
```
